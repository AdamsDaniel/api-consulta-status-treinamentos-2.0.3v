<%- include('../partials/header'); %>
<div class="w-100 h-100 bg-secondary-subtle">
    <% if (success_msg.length > 0) { %>
    <%- include('../partials/erros/success_msg', {
message: success_msg
}); %>
    
    <% } %>
    <% if (error_msg.length > 0) { %>
    <%- include('../partials/erros/error_msg', {
message: error_msg
}); %>
    
    <% } %>
    <nav class="navbar navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="/admin/menu"><i
                    class="bi bi-arrow-left-square"></i></a>
            <a class="navbar-brand">Senhas Geradas</a>
            <button class="navbar-toggler" type="button"
                data-bs-toggle="offcanvas" data-bs-target="#offcanvasDarkNavbar"
                aria-controls="offcanvasDarkNavbar"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1"
                id="offcanvasDarkNavbar"
                aria-labelledby="offcanvasDarkNavbarLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasDarkNavbarLabel">
                        Senhas Geradas
                    </h5>
                    <button type="button" class="btn-close btn-close-white"
                        data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page"
                                href="/admin/menu"><i class="bi bi-house"></i> Início</a>
                        </li>
                    </ul>
                    <form id="form-search-input" class="d-flex mt-3"
                        role="search">
                        <input id="input-search-user" class="form-control me-2"
                            type="number" placeholder="Matricula" aria-label="Search">
                        <button id="search-user" class="btn btn-success"
                            type="submit">Buscar</button>
                    </form>
                </div>
            </div>
        </div>
    </nav>

    <div style="padding-top: 6rem;"
        class="container d-flex justify-content-center align-items-center flex-column gap-4">
        <% if (passwords) { %>
        <% passwords.forEach(pass => { %>
        <%- include('../partials/card-generated-password', {pass}); %>
        <% }) %>
        <% }%>

        <% if(passwords.length === 0 && search == true) { %>
            <h1 class="h5 text-center">Não há senhas geradas para a matrícula especificada.</h1>
        <%}%>

        <% if(passwords.length === 0 && search == false) { %>
            <h1 class="h5 text-center">Não há senhas temporárias geradas.</h1>
        <%}%>
            
    </div>

</div>
</div>

<script src="/js/copyPasswordToClipoard.js"></script>
<script>
    const btnId = document.getElementById('search-user')

    btnId.onclick = () => {
        const input = document.getElementById('input-search-user')
        const formId = document.getElementById('form-search-input')

        if (formId) {
            if (input.value.length > 0) {
                formId.method = 'get'
                formId.action = `/admin/manage-users/generated-passwords/${input.value}`
                formId.submit()
            } else {
                formId.method = 'get'
                formId.action = `/admin/manage-users/generated-passwords`
                formId.submit()
            }
        }
    }
</script>
<%- include('../partials/footer'); %>